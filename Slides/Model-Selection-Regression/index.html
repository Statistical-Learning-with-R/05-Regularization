<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Model Selection in Regression</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.7/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Model Selection in Regression

---






&lt;style type="text/css"&gt;
.red{ color: red; }
.blue{ color: blue; }
.huge {
  font-size: 200%;
}
.large {
  font-size: 150%;
}
.tiny {
  font-size: 50%;
}
&lt;/style&gt;
---
class: center, middle, inverse

# Variable Selection

---
## Variable Selection

Why might we **not** want to include all the variables available to us?

--

* **Overfitting:**  Using many extra variables gives the model more flexibility; it might be to tailored to the training data.
    + Recall:  Polynomials in week 1

--

* **Interpretability:** We'd like to know which variables "matter most" to the response, and have accurate coefficient estimates.
    + What if two variables measure the same information?
    + What if the variables are *linearly dependent*?
    
---
## Data

Recall:  62 unique words describing Cannabis strains.
New Response variable: `Rating`


```r
cann &lt;- read_csv("https://www.dropbox.com/s/s2a1uoiegitupjc/cannabis_full.csv?dl=1")

cann &lt;- cann %&gt;%
  select(-Type, -Strain, -Effects, -Flavor, -Dry, -Mouth)

head(cann)
```

```
## # A tibble: 6 x 63
##   Rating Creative Energetic Tingly Euphoric Relaxed Aroused Happy Uplifted
##    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1    4          1         1      1        1       1       0     0        0
## 2    4.7        1         1      0        0       1       1     1        0
## 3    4.4        1         1      0        0       1       0     1        1
## 4    4.2        1         0      1        0       1       0     0        1
## 5    4.6        0         0      0        1       1       0     1        1
## 6    0          0         0      0        0       0       0     0        0
## # ... with 54 more variables: Hungry &lt;dbl&gt;, Talkative &lt;dbl&gt;, Giggly &lt;dbl&gt;,
## #   Focused &lt;dbl&gt;, Sleepy &lt;dbl&gt;, Earthy &lt;dbl&gt;, Sweet &lt;dbl&gt;, Citrus &lt;dbl&gt;,
## #   Flowery &lt;dbl&gt;, Violet &lt;dbl&gt;, Diesel &lt;dbl&gt;, Spicy/Herbal &lt;dbl&gt;, Sage &lt;dbl&gt;,
## #   Woody &lt;dbl&gt;, Apricot &lt;dbl&gt;, Grapefruit &lt;dbl&gt;, Orange &lt;dbl&gt;, Pungent &lt;dbl&gt;,
## #   Grape &lt;dbl&gt;, Pine &lt;dbl&gt;, Skunk &lt;dbl&gt;, Berry &lt;dbl&gt;, Pepper &lt;dbl&gt;,
## #   Menthol &lt;dbl&gt;, Blue &lt;dbl&gt;, Cheese &lt;dbl&gt;, Chemical &lt;dbl&gt;, Mango &lt;dbl&gt;,
## #   Lemon &lt;dbl&gt;, Peach &lt;dbl&gt;, Vanilla &lt;dbl&gt;, Nutty &lt;dbl&gt;, Chestnut &lt;dbl&gt;,
## #   Tea &lt;dbl&gt;, Tobacco &lt;dbl&gt;, Tropical &lt;dbl&gt;, Strawberry &lt;dbl&gt;,
## #   Blueberry &lt;dbl&gt;, Mint &lt;dbl&gt;, Apple &lt;dbl&gt;, Honey &lt;dbl&gt;, Lavender &lt;dbl&gt;,
## #   Lime &lt;dbl&gt;, Coffee &lt;dbl&gt;, Ammonia &lt;dbl&gt;, Minty &lt;dbl&gt;, Tree &lt;dbl&gt;,
## #   Fruit &lt;dbl&gt;, Butter &lt;dbl&gt;, Pineapple &lt;dbl&gt;, Tar &lt;dbl&gt;, Rose &lt;dbl&gt;,
## #   Plum &lt;dbl&gt;, Pear &lt;dbl&gt;
```

    
---
## Option 1: Best Subset Selection

Let's try **every possible subset** of variables and pick the best one.

--

What do we mean by **best**?

--

Penalized metrics:

* BIC
* AIC
* Mallow's Cp
* Adjusted R-squared

--

Cross-Validation???

---
## Option 1: Best Subset Selection

The problem:

--

```
Rating ~ Creative
Rating ~ Creative + Energetic
Rating ~ Creative + Energetic + Tingly
Rating ~ Creative + Tingly
...
```

--

62 variables = 4.6 quintillion models

--

(Plus cross-validation????)

---
class: center, middle

![](https://media0.giphy.com/media/LSQcHeCzIxfmUoV2mj/200.gif)

---
## Option 1: Best Subset Selection

If you have only a few variables, go for it.

--

In realistic settings, it's not practical.

--

Use the `leaps` package.

---
## Best Subset Selection with `leaps`

Best model of each size, based on R-squared:


```r
library(leaps)
models &lt;- regsubsets(Rating ~ Creative + Energetic + Tingly, 
                     data = cann, method = "exhaustive")

summary(models)
```

```
## Subset selection object
## Call: regsubsets.formula(Rating ~ Creative + Energetic + Tingly, data = cann, 
##     method = "exhaustive")
## 3 Variables  (and intercept)
##           Forced in Forced out
## Creative      FALSE      FALSE
## Energetic     FALSE      FALSE
## Tingly        FALSE      FALSE
## 1 subsets of each size up to 3
## Selection Algorithm: exhaustive
##          Creative Energetic Tingly
## 1  ( 1 ) "*"      " "       " "   
## 2  ( 1 ) "*"      "*"       " "   
## 3  ( 1 ) "*"      "*"       "*"
```
---
class: center, middle, inverse

# Why can we compare same-size models via R-squared, not penalized metrics or cross-validation?

---
## Best Subset Selection with `leaps`

Now compare same-size models:


```r
summary(models)$adjr2  # bigger is better
```

```
## [1] 0.01006460 0.01400814 0.01633805
```

```r
summary(models)$cp     # smaller is better
```

```
## [1] 16.694102  8.454895  4.000000
```

```r
summary(models)$bic    # more negative is better
```

```
## [1]  -8.840652 -11.303084 -10.016876
```

---
## Option 2: Backwards Selection

Start with **all** candidate variables in the model.

--

Drop the *worst* variable.  (p-vals or R-squared)

--

Check if dropping it helped.  (penalized metric or cross-validation)

--

Stop when dropping is no longer good.

---
## Backwards selection with `leaps`


```r
models &lt;- regsubsets(Rating ~ ., 
                     data = cann, method = "forward",
                     nvmax = 61)
```

```
## Reordering variables and trying again:
```

```r
summary(models)
```

```
## Subset selection object
## Call: regsubsets.formula(Rating ~ ., data = cann, method = "forward", 
##     nvmax = 61)
## 62 Variables  (and intercept)
##                Forced in Forced out
## Creative           FALSE      FALSE
## Energetic          FALSE      FALSE
## Tingly             FALSE      FALSE
## Euphoric           FALSE      FALSE
## Relaxed            FALSE      FALSE
## Aroused            FALSE      FALSE
## Happy              FALSE      FALSE
## Uplifted           FALSE      FALSE
## Hungry             FALSE      FALSE
## Talkative          FALSE      FALSE
## Giggly             FALSE      FALSE
## Focused            FALSE      FALSE
## Sleepy             FALSE      FALSE
## Earthy             FALSE      FALSE
## Sweet              FALSE      FALSE
## Citrus             FALSE      FALSE
## Flowery            FALSE      FALSE
## Violet             FALSE      FALSE
## Diesel             FALSE      FALSE
## `Spicy/Herbal`     FALSE      FALSE
## Sage               FALSE      FALSE
## Woody              FALSE      FALSE
## Apricot            FALSE      FALSE
## Grapefruit         FALSE      FALSE
## Orange             FALSE      FALSE
## Pungent            FALSE      FALSE
## Grape              FALSE      FALSE
## Pine               FALSE      FALSE
## Skunk              FALSE      FALSE
## Berry              FALSE      FALSE
## Pepper             FALSE      FALSE
## Menthol            FALSE      FALSE
## Blue               FALSE      FALSE
## Cheese             FALSE      FALSE
## Chemical           FALSE      FALSE
## Mango              FALSE      FALSE
## Lemon              FALSE      FALSE
## Peach              FALSE      FALSE
## Vanilla            FALSE      FALSE
## Nutty              FALSE      FALSE
## Chestnut           FALSE      FALSE
## Tea                FALSE      FALSE
## Tobacco            FALSE      FALSE
## Tropical           FALSE      FALSE
## Strawberry         FALSE      FALSE
## Blueberry          FALSE      FALSE
## Mint               FALSE      FALSE
## Apple              FALSE      FALSE
## Honey              FALSE      FALSE
## Lavender           FALSE      FALSE
## Lime               FALSE      FALSE
## Coffee             FALSE      FALSE
## Ammonia            FALSE      FALSE
## Minty              FALSE      FALSE
## Tree               FALSE      FALSE
## Butter             FALSE      FALSE
## Pineapple          FALSE      FALSE
## Tar                FALSE      FALSE
## Rose               FALSE      FALSE
## Plum               FALSE      FALSE
## Pear               FALSE      FALSE
## Fruit              FALSE      FALSE
## 1 subsets of each size up to 61
## Selection Algorithm: forward
##           Creative Energetic Tingly Euphoric Relaxed Aroused Happy Uplifted
## 1  ( 1 )  " "      " "       " "    " "      " "     " "     "*"   " "     
## 2  ( 1 )  " "      " "       " "    " "      "*"     " "     "*"   " "     
## 3  ( 1 )  " "      " "       " "    " "      "*"     " "     "*"   "*"     
## 4  ( 1 )  "*"      " "       " "    " "      "*"     " "     "*"   "*"     
## 5  ( 1 )  "*"      " "       " "    "*"      "*"     " "     "*"   "*"     
## 6  ( 1 )  "*"      "*"       " "    "*"      "*"     " "     "*"   "*"     
## 7  ( 1 )  "*"      "*"       " "    "*"      "*"     " "     "*"   "*"     
## 8  ( 1 )  "*"      "*"       " "    "*"      "*"     " "     "*"   "*"     
## 9  ( 1 )  "*"      "*"       " "    "*"      "*"     " "     "*"   "*"     
## 10  ( 1 ) "*"      "*"       " "    "*"      "*"     "*"     "*"   "*"     
## 11  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 12  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 13  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 14  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 15  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 16  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 17  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 18  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 19  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 20  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 21  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 22  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 23  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 24  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 25  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 26  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 27  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 28  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 29  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 30  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 31  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 32  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 33  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 34  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 35  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 36  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 37  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 38  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 39  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 40  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 41  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 42  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 43  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 44  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 45  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 46  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 47  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 48  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 49  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 50  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 51  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 52  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 53  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 54  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 55  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 56  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 57  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 58  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 59  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 60  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
## 61  ( 1 ) "*"      "*"       "*"    "*"      "*"     "*"     "*"   "*"     
##           Hungry Talkative Giggly Focused Sleepy Earthy Sweet Citrus Flowery
## 1  ( 1 )  " "    " "       " "    " "     " "    " "    " "   " "    " "    
## 2  ( 1 )  " "    " "       " "    " "     " "    " "    " "   " "    " "    
## 3  ( 1 )  " "    " "       " "    " "     " "    " "    " "   " "    " "    
## 4  ( 1 )  " "    " "       " "    " "     " "    " "    " "   " "    " "    
## 5  ( 1 )  " "    " "       " "    " "     " "    " "    " "   " "    " "    
## 6  ( 1 )  " "    " "       " "    " "     " "    " "    " "   " "    " "    
## 7  ( 1 )  " "    " "       " "    " "     "*"    " "    " "   " "    " "    
## 8  ( 1 )  " "    "*"       " "    " "     "*"    " "    " "   " "    " "    
## 9  ( 1 )  " "    "*"       " "    "*"     "*"    " "    " "   " "    " "    
## 10  ( 1 ) " "    "*"       " "    "*"     "*"    " "    " "   " "    " "    
## 11  ( 1 ) " "    "*"       " "    "*"     "*"    " "    " "   " "    " "    
## 12  ( 1 ) "*"    "*"       " "    "*"     "*"    " "    " "   " "    " "    
## 13  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 14  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 15  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 16  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 17  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 18  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 19  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 20  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 21  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 22  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    " "    
## 23  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    " "   " "    "*"    
## 24  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   " "    "*"    
## 25  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   " "    "*"    
## 26  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   " "    "*"    
## 27  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   " "    "*"    
## 28  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   " "    "*"    
## 29  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   " "    "*"    
## 30  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   "*"    "*"    
## 31  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   "*"    "*"    
## 32  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   "*"    "*"    
## 33  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   "*"    "*"    
## 34  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   "*"    "*"    
## 35  ( 1 ) "*"    "*"       "*"    "*"     "*"    " "    "*"   "*"    "*"    
## 36  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 37  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 38  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 39  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 40  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 41  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 42  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 43  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 44  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 45  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 46  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 47  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 48  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 49  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 50  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 51  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 52  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 53  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 54  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 55  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 56  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 57  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 58  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 59  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 60  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
## 61  ( 1 ) "*"    "*"       "*"    "*"     "*"    "*"    "*"   "*"    "*"    
##           Violet Diesel `Spicy/Herbal` Sage Woody Apricot Grapefruit Orange
## 1  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 2  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 3  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 4  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 5  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 6  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 7  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 8  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 9  ( 1 )  " "    " "    " "            " "  " "   " "     " "        " "   
## 10  ( 1 ) " "    " "    " "            " "  " "   " "     " "        " "   
## 11  ( 1 ) " "    " "    " "            " "  " "   " "     " "        " "   
## 12  ( 1 ) " "    " "    " "            " "  " "   " "     " "        " "   
## 13  ( 1 ) " "    " "    " "            " "  " "   " "     " "        " "   
## 14  ( 1 ) " "    " "    " "            " "  "*"   " "     " "        " "   
## 15  ( 1 ) " "    " "    " "            " "  "*"   " "     " "        " "   
## 16  ( 1 ) " "    " "    " "            " "  "*"   " "     " "        " "   
## 17  ( 1 ) " "    " "    " "            " "  "*"   " "     " "        " "   
## 18  ( 1 ) " "    " "    " "            " "  "*"   " "     " "        " "   
## 19  ( 1 ) " "    " "    " "            " "  "*"   " "     " "        " "   
## 20  ( 1 ) " "    " "    " "            " "  "*"   " "     " "        " "   
## 21  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 22  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 23  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 24  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 25  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 26  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 27  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 28  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 29  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 30  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 31  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 32  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 33  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 34  ( 1 ) " "    " "    "*"            " "  "*"   " "     " "        " "   
## 35  ( 1 ) " "    "*"    "*"            " "  "*"   " "     " "        " "   
## 36  ( 1 ) " "    "*"    "*"            " "  "*"   " "     " "        " "   
## 37  ( 1 ) " "    "*"    "*"            " "  "*"   " "     " "        " "   
## 38  ( 1 ) " "    "*"    "*"            " "  "*"   " "     " "        " "   
## 39  ( 1 ) " "    "*"    "*"            " "  "*"   " "     " "        "*"   
## 40  ( 1 ) " "    "*"    "*"            " "  "*"   " "     " "        "*"   
## 41  ( 1 ) " "    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 42  ( 1 ) " "    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 43  ( 1 ) " "    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 44  ( 1 ) " "    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 45  ( 1 ) " "    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 46  ( 1 ) " "    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 47  ( 1 ) " "    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 48  ( 1 ) " "    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 49  ( 1 ) "*"    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 50  ( 1 ) "*"    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 51  ( 1 ) "*"    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 52  ( 1 ) "*"    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 53  ( 1 ) "*"    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 54  ( 1 ) "*"    "*"    "*"            "*"  "*"   " "     " "        "*"   
## 55  ( 1 ) "*"    "*"    "*"            "*"  "*"   "*"     " "        "*"   
## 56  ( 1 ) "*"    "*"    "*"            "*"  "*"   "*"     "*"        "*"   
## 57  ( 1 ) "*"    "*"    "*"            "*"  "*"   "*"     "*"        "*"   
## 58  ( 1 ) "*"    "*"    "*"            "*"  "*"   "*"     "*"        "*"   
## 59  ( 1 ) "*"    "*"    "*"            "*"  "*"   "*"     "*"        "*"   
## 60  ( 1 ) "*"    "*"    "*"            "*"  "*"   "*"     "*"        "*"   
## 61  ( 1 ) "*"    "*"    "*"            "*"  "*"   "*"     "*"        "*"   
##           Pungent Grape Pine Skunk Berry Pepper Menthol Blue Cheese Chemical
## 1  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 2  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 3  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 4  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 5  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 6  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 7  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 8  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 9  ( 1 )  " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 10  ( 1 ) " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 11  ( 1 ) " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 12  ( 1 ) " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 13  ( 1 ) " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 14  ( 1 ) " "     " "   " "  " "   " "   " "    " "     " "  " "    " "     
## 15  ( 1 ) " "     " "   " "  " "   " "   " "    " "     " "  "*"    " "     
## 16  ( 1 ) " "     " "   " "  " "   " "   " "    " "     " "  "*"    " "     
## 17  ( 1 ) " "     " "   " "  " "   " "   " "    " "     " "  "*"    " "     
## 18  ( 1 ) " "     " "   " "  " "   "*"   " "    " "     " "  "*"    " "     
## 19  ( 1 ) " "     " "   " "  " "   "*"   " "    "*"     " "  "*"    " "     
## 20  ( 1 ) " "     " "   " "  " "   "*"   " "    "*"     " "  "*"    " "     
## 21  ( 1 ) " "     " "   " "  " "   "*"   " "    "*"     " "  "*"    " "     
## 22  ( 1 ) " "     " "   " "  " "   "*"   " "    "*"     " "  "*"    " "     
## 23  ( 1 ) " "     " "   " "  " "   "*"   " "    "*"     " "  "*"    " "     
## 24  ( 1 ) " "     " "   " "  " "   "*"   " "    "*"     " "  "*"    " "     
## 25  ( 1 ) " "     " "   "*"  " "   "*"   " "    "*"     " "  "*"    " "     
## 26  ( 1 ) " "     " "   "*"  " "   "*"   " "    "*"     " "  "*"    " "     
## 27  ( 1 ) " "     " "   "*"  " "   "*"   " "    "*"     " "  "*"    " "     
## 28  ( 1 ) " "     " "   "*"  " "   "*"   "*"    "*"     " "  "*"    " "     
## 29  ( 1 ) "*"     " "   "*"  " "   "*"   "*"    "*"     " "  "*"    " "     
## 30  ( 1 ) "*"     " "   "*"  " "   "*"   "*"    "*"     " "  "*"    " "     
## 31  ( 1 ) "*"     " "   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 32  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 33  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 34  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 35  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 36  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 37  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 38  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 39  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 40  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 41  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 42  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    " "     
## 43  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 44  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 45  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 46  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 47  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 48  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 49  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 50  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 51  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 52  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 53  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 54  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 55  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 56  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 57  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     " "  "*"    "*"     
## 58  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     "*"  "*"    "*"     
## 59  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     "*"  "*"    "*"     
## 60  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     "*"  "*"    "*"     
## 61  ( 1 ) "*"     "*"   "*"  "*"   "*"   "*"    "*"     "*"  "*"    "*"     
##           Mango Lemon Peach Vanilla Nutty Chestnut Tea Tobacco Tropical
## 1  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 2  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 3  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 4  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 5  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 6  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 7  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 8  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 9  ( 1 )  " "   " "   " "   " "     " "   " "      " " " "     " "     
## 10  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 11  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 12  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 13  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 14  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 15  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 16  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 17  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 18  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 19  ( 1 ) " "   " "   " "   " "     " "   " "      " " " "     " "     
## 20  ( 1 ) " "   " "   "*"   " "     " "   " "      " " " "     " "     
## 21  ( 1 ) " "   " "   "*"   " "     " "   " "      " " " "     " "     
## 22  ( 1 ) " "   " "   "*"   " "     " "   " "      " " " "     " "     
## 23  ( 1 ) " "   " "   "*"   " "     " "   " "      " " " "     " "     
## 24  ( 1 ) " "   " "   "*"   " "     " "   " "      " " " "     " "     
## 25  ( 1 ) " "   " "   "*"   " "     " "   " "      " " " "     " "     
## 26  ( 1 ) " "   " "   "*"   " "     " "   "*"      " " " "     " "     
## 27  ( 1 ) " "   " "   "*"   " "     " "   "*"      " " " "     " "     
## 28  ( 1 ) " "   " "   "*"   " "     " "   "*"      " " " "     " "     
## 29  ( 1 ) " "   " "   "*"   " "     " "   "*"      " " " "     " "     
## 30  ( 1 ) " "   " "   "*"   " "     " "   "*"      " " " "     " "     
## 31  ( 1 ) " "   " "   "*"   " "     " "   "*"      " " " "     " "     
## 32  ( 1 ) " "   " "   "*"   " "     " "   "*"      " " " "     " "     
## 33  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     " "     
## 34  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 35  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 36  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 37  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 38  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 39  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 40  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 41  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 42  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 43  ( 1 ) " "   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 44  ( 1 ) "*"   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 45  ( 1 ) "*"   "*"   "*"   " "     " "   "*"      " " " "     "*"     
## 46  ( 1 ) "*"   "*"   "*"   "*"     " "   "*"      " " " "     "*"     
## 47  ( 1 ) "*"   "*"   "*"   "*"     " "   "*"      " " " "     "*"     
## 48  ( 1 ) "*"   "*"   "*"   "*"     " "   "*"      " " " "     "*"     
## 49  ( 1 ) "*"   "*"   "*"   "*"     " "   "*"      " " " "     "*"     
## 50  ( 1 ) "*"   "*"   "*"   "*"     " "   "*"      " " " "     "*"     
## 51  ( 1 ) "*"   "*"   "*"   "*"     " "   "*"      " " " "     "*"     
## 52  ( 1 ) "*"   "*"   "*"   "*"     " "   "*"      " " " "     "*"     
## 53  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      " " " "     "*"     
## 54  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      " " " "     "*"     
## 55  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      " " " "     "*"     
## 56  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      " " " "     "*"     
## 57  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      "*" " "     "*"     
## 58  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      "*" " "     "*"     
## 59  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      "*" " "     "*"     
## 60  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      "*" " "     "*"     
## 61  ( 1 ) "*"   "*"   "*"   "*"     "*"   "*"      "*" "*"     "*"     
##           Strawberry Blueberry Mint Apple Honey Lavender Lime Coffee Ammonia
## 1  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 2  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 3  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 4  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 5  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 6  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 7  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 8  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 9  ( 1 )  " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 10  ( 1 ) " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 11  ( 1 ) " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 12  ( 1 ) " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 13  ( 1 ) " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 14  ( 1 ) " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 15  ( 1 ) " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 16  ( 1 ) " "        " "       " "  " "   " "   " "      " "  " "    " "    
## 17  ( 1 ) " "        " "       " "  "*"   " "   " "      " "  " "    " "    
## 18  ( 1 ) " "        " "       " "  "*"   " "   " "      " "  " "    " "    
## 19  ( 1 ) " "        " "       " "  "*"   " "   " "      " "  " "    " "    
## 20  ( 1 ) " "        " "       " "  "*"   " "   " "      " "  " "    " "    
## 21  ( 1 ) " "        " "       " "  "*"   " "   " "      " "  " "    " "    
## 22  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  " "    " "    
## 23  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  " "    " "    
## 24  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  " "    " "    
## 25  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  " "    " "    
## 26  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  " "    " "    
## 27  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 28  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 29  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 30  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 31  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 32  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 33  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 34  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 35  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 36  ( 1 ) " "        " "       " "  "*"   " "   " "      "*"  "*"    " "    
## 37  ( 1 ) " "        "*"       " "  "*"   " "   " "      "*"  "*"    " "    
## 38  ( 1 ) " "        "*"       " "  "*"   "*"   " "      "*"  "*"    " "    
## 39  ( 1 ) " "        "*"       " "  "*"   "*"   " "      "*"  "*"    " "    
## 40  ( 1 ) " "        "*"       " "  "*"   "*"   " "      "*"  "*"    "*"    
## 41  ( 1 ) " "        "*"       " "  "*"   "*"   " "      "*"  "*"    "*"    
## 42  ( 1 ) " "        "*"       " "  "*"   "*"   "*"      "*"  "*"    "*"    
## 43  ( 1 ) " "        "*"       " "  "*"   "*"   "*"      "*"  "*"    "*"    
## 44  ( 1 ) " "        "*"       " "  "*"   "*"   "*"      "*"  "*"    "*"    
## 45  ( 1 ) "*"        "*"       " "  "*"   "*"   "*"      "*"  "*"    "*"    
## 46  ( 1 ) "*"        "*"       " "  "*"   "*"   "*"      "*"  "*"    "*"    
## 47  ( 1 ) "*"        "*"       " "  "*"   "*"   "*"      "*"  "*"    "*"    
## 48  ( 1 ) "*"        "*"       " "  "*"   "*"   "*"      "*"  "*"    "*"    
## 49  ( 1 ) "*"        "*"       " "  "*"   "*"   "*"      "*"  "*"    "*"    
## 50  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 51  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 52  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 53  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 54  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 55  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 56  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 57  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 58  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 59  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 60  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
## 61  ( 1 ) "*"        "*"       "*"  "*"   "*"   "*"      "*"  "*"    "*"    
##           Minty Tree Fruit Butter Pineapple Tar Rose Plum Pear
## 1  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 2  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 3  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 4  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 5  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 6  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 7  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 8  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 9  ( 1 )  " "   " "  " "   " "    " "       " " " "  " "  " " 
## 10  ( 1 ) " "   " "  " "   " "    " "       " " " "  " "  " " 
## 11  ( 1 ) " "   " "  " "   " "    " "       " " " "  " "  " " 
## 12  ( 1 ) " "   " "  " "   " "    " "       " " " "  " "  " " 
## 13  ( 1 ) " "   " "  " "   " "    " "       " " " "  " "  " " 
## 14  ( 1 ) " "   " "  " "   " "    " "       " " " "  " "  " " 
## 15  ( 1 ) " "   " "  " "   " "    " "       " " " "  " "  " " 
## 16  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 17  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 18  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 19  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 20  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 21  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 22  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 23  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 24  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 25  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 26  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 27  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 28  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 29  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 30  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 31  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 32  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 33  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 34  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 35  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 36  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 37  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 38  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 39  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 40  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 41  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 42  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 43  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 44  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 45  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 46  ( 1 ) "*"   " "  " "   " "    " "       " " " "  " "  " " 
## 47  ( 1 ) "*"   "*"  " "   " "    " "       " " " "  " "  " " 
## 48  ( 1 ) "*"   "*"  " "   " "    " "       "*" " "  " "  " " 
## 49  ( 1 ) "*"   "*"  " "   " "    " "       "*" " "  " "  " " 
## 50  ( 1 ) "*"   "*"  " "   " "    " "       "*" " "  " "  " " 
## 51  ( 1 ) "*"   "*"  " "   "*"    " "       "*" " "  " "  " " 
## 52  ( 1 ) "*"   "*"  " "   "*"    " "       "*" "*"  " "  " " 
## 53  ( 1 ) "*"   "*"  " "   "*"    " "       "*" "*"  " "  " " 
## 54  ( 1 ) "*"   "*"  " "   "*"    " "       "*" "*"  " "  "*" 
## 55  ( 1 ) "*"   "*"  " "   "*"    " "       "*" "*"  " "  "*" 
## 56  ( 1 ) "*"   "*"  " "   "*"    " "       "*" "*"  " "  "*" 
## 57  ( 1 ) "*"   "*"  " "   "*"    " "       "*" "*"  " "  "*" 
## 58  ( 1 ) "*"   "*"  " "   "*"    " "       "*" "*"  " "  "*" 
## 59  ( 1 ) "*"   "*"  " "   "*"    "*"       "*" "*"  " "  "*" 
## 60  ( 1 ) "*"   "*"  " "   "*"    "*"       "*" "*"  "*"  "*" 
## 61  ( 1 ) "*"   "*"  " "   "*"    "*"       "*" "*"  "*"  "*"
```

---
## Backwards selection with `leaps`


```r
bic_scores &lt;- summary(models)$bic
bic_scores
```

```
##  [1]  -186.0198  -279.0113  -360.9948  -429.0414  -491.9711  -552.6699
##  [7]  -614.3485  -696.0323  -789.0044  -872.2932  -952.9270 -1057.7093
## [13] -1159.2405 -1155.8796 -1151.6375 -1147.1778 -1142.0944 -1136.8903
## [19] -1131.0153 -1124.9173 -1118.6714 -1112.3934 -1106.1547 -1100.0338
## [25] -1093.6837 -1087.3238 -1080.7822 -1073.9061 -1066.9540 -1060.2642
## [31] -1053.5735 -1047.0155 -1040.4737 -1034.2006 -1028.1425 -1022.7423
## [37] -1016.8925 -1010.8436 -1004.8660  -998.7483  -992.8478  -986.6821
## [43]  -980.4454  -973.7643  -967.0669  -959.9159  -952.8325  -945.6575
## [49]  -938.3867  -931.0882  -923.7410  -916.3736  -909.0185  -901.6542
## [55]  -894.1702  -886.6639  -879.0910  -871.4425  -863.7226  -855.9846
## [61]  -848.2431
```

---
## Backwards selection with `leaps`

![](index_files/figure-html/unnamed-chunk-7-1.png)&lt;!-- --&gt;

---
## Backwards selection with `leaps`


```r
which.min(bic_scores)
```

```
## [1] 13
```

```r
summary(models)$outmat[13,]
```

```
##       Creative      Energetic         Tingly       Euphoric        Relaxed 
##            "*"            "*"            "*"            "*"            "*" 
##        Aroused          Happy       Uplifted         Hungry      Talkative 
##            "*"            "*"            "*"            "*"            "*" 
##         Giggly        Focused         Sleepy         Earthy          Sweet 
##            "*"            "*"            "*"            " "            " " 
##         Citrus        Flowery         Violet         Diesel `Spicy/Herbal` 
##            " "            " "            " "            " "            " " 
##           Sage          Woody        Apricot     Grapefruit         Orange 
##            " "            " "            " "            " "            " " 
##        Pungent          Grape           Pine          Skunk          Berry 
##            " "            " "            " "            " "            " " 
##         Pepper        Menthol           Blue         Cheese       Chemical 
##            " "            " "            " "            " "            " " 
##          Mango          Lemon          Peach        Vanilla          Nutty 
##            " "            " "            " "            " "            " " 
##       Chestnut            Tea        Tobacco       Tropical     Strawberry 
##            " "            " "            " "            " "            " " 
##      Blueberry           Mint          Apple          Honey       Lavender 
##            " "            " "            " "            " "            " " 
##           Lime         Coffee        Ammonia          Minty           Tree 
##            " "            " "            " "            " "            " " 
##          Fruit         Butter      Pineapple            Tar           Rose 
##            " "            " "            " "            " "            " " 
##           Plum           Pear 
##            " "            " "
```

---
## Option 1: Best Subset Selection

Start with **one variable** that you think is best.

--

Add the *next best variable*.

--

Test whether it was worth adding.

--

Keep going until it's not worth adding any more variables.

---
class: center, middle, inverse

# Try it!

## Open **Activity-Variable-Selection**
#### Determine the best model via **backwards selection**.  Fit that model to the data and report results.
#### Determine the best model via **forwards selection**.  Fit that model to the data and report results.


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLines": true,
"highlightStyle": "github",
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
